a = -log10(0.05);[SDI_grad_r_avg,SDI_grad_p_avg,SDI_grad_r_sub,SDI_grad_p_sub,SDI_grad_NElogp_sub] = avg_1_SDI(SDI_cov_sub,alignGrad,grad);function [SDI_grad_r_avg,SDI_grad_p_avg,SDI_grad_r_sub,SDI_grad_p_sub,SDI_grad_NElogp_sub] = avg_1_SDI(SDI,alignGrad,grad)    SDI_grad_r_avg = cell(1,3);    SDI_grad_p_avg = cell(1,3);%     SDI_grad_r_sub = cell(3);%     SDI_grad_p_sub = cell(3);%     SDI_grad_NElogp_sub = cell(3);%                     grad_NC_avg = zeros(246);    for center = 1:7        grad_NC_avg(:,center) = alignGrad{center};    end    grad_NC_avg = mean(grad_NC_avg,2);        for mode = 1:3        count1=1;        for center = 1:7            for group = 1:3                avg_list = squeeze(mean(SDI{mode}{center,group},2));                a = alignGrad{center + (group-1)*7};                                [SDI_grad_r_avg{mode}(center,group),SDI_grad_p_avg{mode}(center,group)] = ...                    corr(avg_list,alignGrad{center + (group-1)*7});                                size1 = size(SDI{mode}{center,group});                for sub = 1:size1(2)                                        [SDI_grad_r_sub(mode,count1),SDI_grad_p_sub(mode,count1)]= ...                        corr(SDI{mode}{center,group}(:,sub),grad{center,group}(:,sub));                                        [a,b] = corr(SDI{mode}{center,group}(:,sub),grad{center,group}(:,sub));                                        SDI_grad_NElogp_sub(mode,count1) = -log10(SDI_grad_p_sub(mode,count1));                    count1 = count1+1;                end            end        end    endend